{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jiashunli/Desktop/legendary-waffle/Mern Stack/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/jiashunli/Desktop/legendary-waffle/Mern Stack/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jiashunli/Desktop/legendary-waffle/Mern Stack/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from'react';import{useAuthContext}from'./useAuthContext';export var useProfile=function useProfile(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useAuthContext=useAuthContext(),user=_useAuthContext.user,dispatch=_useAuthContext.dispatch;var updateProfile=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(profileData){var response,json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoading(true);setError(null);_context.next=4;return fetch('/api/user/profile',{method:'PUT',headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(user.token)},body:JSON.stringify(profileData)});case 4:response=_context.sent;_context.next=7;return response.json();case 7:json=_context.sent;if(!response.ok){setIsLoading(false);setError(json.error);}if(response.ok){// update the user in local storage\nlocalStorage.setItem('user',JSON.stringify(json));// update the auth context\ndispatch({type:'UPDATE_PROFILE',payload:json});// update loading state\nsetIsLoading(false);}case 10:case\"end\":return _context.stop();}},_callee);}));return function updateProfile(_x){return _ref.apply(this,arguments);};}();return{updateProfile:updateProfile,isLoading:isLoading,error:error};};","map":{"version":3,"names":["useState","useAuthContext","useProfile","error","setError","isLoading","setIsLoading","user","dispatch","updateProfile","profileData","fetch","method","headers","Authorization","token","body","JSON","stringify","response","json","ok","localStorage","setItem","type","payload"],"sources":["/Users/jiashunli/Desktop/legendary-waffle/Mern Stack/frontend/src/hooks/useProfile.js"],"sourcesContent":["import { useState } from 'react';\nimport { useAuthContext } from './useAuthContext';\n\nexport const useProfile = () => {\n  const [error, setError] = useState(null);\n  const [isLoading, setIsLoading] = useState(null);\n  const { user, dispatch } = useAuthContext();\n\n  const updateProfile = async (profileData) => {\n    setIsLoading(true);\n    setError(null);\n\n    const response = await fetch('/api/user/profile', {\n      method: 'PUT',\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${user.token}`,\n      },\n      body: JSON.stringify(profileData)\n    });\n    const json = await response.json();\n\n    if (!response.ok) {\n      setIsLoading(false);\n      setError(json.error);\n    }\n    if (response.ok) {\n      // update the user in local storage\n      localStorage.setItem('user', JSON.stringify(json));\n\n      // update the auth context\n      dispatch({ type: 'UPDATE_PROFILE', payload: json });\n\n      // update loading state\n      setIsLoading(false);\n    }\n  };\n\n  return { updateProfile, isLoading, error };\n};\n"],"mappings":"ycAAA,OAASA,QAAQ,KAAQ,OAAO,CAChC,OAASC,cAAc,KAAQ,kBAAkB,CAEjD,MAAO,IAAMC,WAAU,CAAG,QAAbA,WAAU,EAAS,CAC9B,cAA0BF,QAAQ,CAAC,IAAI,CAAC,wCAAjCG,KAAK,eAAEC,QAAQ,eACtB,eAAkCJ,QAAQ,CAAC,IAAI,CAAC,yCAAzCK,SAAS,eAAEC,YAAY,eAC9B,oBAA2BL,cAAc,EAAE,CAAnCM,IAAI,iBAAJA,IAAI,CAAEC,QAAQ,iBAARA,QAAQ,CAEtB,GAAMC,cAAa,4FAAG,iBAAOC,WAAW,qIACtCJ,YAAY,CAAC,IAAI,CAAC,CAClBF,QAAQ,CAAC,IAAI,CAAC,CAAC,sBAEQO,MAAK,CAAC,mBAAmB,CAAE,CAChDC,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClCC,aAAa,kBAAYP,IAAI,CAACQ,KAAK,CACrC,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACR,WAAW,CAClC,CAAC,CAAC,QAPIS,QAAQ,qCAQKA,SAAQ,CAACC,IAAI,EAAE,QAA5BA,IAAI,eAEV,GAAI,CAACD,QAAQ,CAACE,EAAE,CAAE,CAChBf,YAAY,CAAC,KAAK,CAAC,CACnBF,QAAQ,CAACgB,IAAI,CAACjB,KAAK,CAAC,CACtB,CACA,GAAIgB,QAAQ,CAACE,EAAE,CAAE,CACf;AACAC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAEN,IAAI,CAACC,SAAS,CAACE,IAAI,CAAC,CAAC,CAElD;AACAZ,QAAQ,CAAC,CAAEgB,IAAI,CAAE,gBAAgB,CAAEC,OAAO,CAAEL,IAAK,CAAC,CAAC,CAEnD;AACAd,YAAY,CAAC,KAAK,CAAC,CACrB,CAAC,sDACF,kBA5BKG,cAAa,4CA4BlB,CAED,MAAO,CAAEA,aAAa,CAAbA,aAAa,CAAEJ,SAAS,CAATA,SAAS,CAAEF,KAAK,CAALA,KAAM,CAAC,CAC5C,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}