{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jiashunli/Desktop/legendary-waffle/Mern Stack/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/jiashunli/Desktop/legendary-waffle/Mern Stack/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jiashunli/Desktop/legendary-waffle/Mern Stack/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from'react';import{useAuthContext}from'./useAuthContext';export var useDelete=function useDelete(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useAuthContext=useAuthContext(),user=_useAuthContext.user,dispatch=_useAuthContext.dispatch;var deleteUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(email){var response,json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoading(true);setError(null);_context.next=4;return fetch(\"/api/user/\".concat(email),{method:'DELETE',headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(user.token)}});case 4:response=_context.sent;_context.next=7;return response.json();case 7:json=_context.sent;if(!response.ok){setIsLoading(false);setError(json.message);}if(response.ok){// remove the user from local storage\nlocalStorage.removeItem('user');// update the auth context\ndispatch({type:'LOGOUT'});// update loading state\nsetIsLoading(false);}case 10:case\"end\":return _context.stop();}},_callee);}));return function deleteUser(_x){return _ref.apply(this,arguments);};}();return{deleteUser:deleteUser,isLoading:isLoading,error:error};};","map":{"version":3,"names":["useState","useAuthContext","useDelete","error","setError","isLoading","setIsLoading","user","dispatch","deleteUser","email","fetch","method","headers","Authorization","token","response","json","ok","message","localStorage","removeItem","type"],"sources":["/Users/jiashunli/Desktop/legendary-waffle/Mern Stack/frontend/src/hooks/useDelete.js"],"sourcesContent":["import { useState } from 'react';\nimport { useAuthContext } from './useAuthContext';\n\nexport const useDelete = () => {\n  const [error, setError] = useState(null);\n  const [isLoading, setIsLoading] = useState(null);\n  const { user, dispatch } = useAuthContext();\n\n  const deleteUser = async (email) => {\n    setIsLoading(true);\n    setError(null);\n\n    const response = await fetch(`/api/user/${email}`, {\n      method: 'DELETE',\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${user.token}`,\n      },\n    });\n    const json = await response.json();\n\n    if (!response.ok) {\n      setIsLoading(false);\n      setError(json.message);\n    }\n    if (response.ok) {\n      // remove the user from local storage\n      localStorage.removeItem('user');\n\n      // update the auth context\n      dispatch({type: 'LOGOUT'});\n\n      // update loading state\n      setIsLoading(false);\n    }\n  }\n\n  return { deleteUser, isLoading, error };\n}\n"],"mappings":"ycAAA,OAASA,QAAQ,KAAQ,OAAO,CAChC,OAASC,cAAc,KAAQ,kBAAkB,CAEjD,MAAO,IAAMC,UAAS,CAAG,QAAZA,UAAS,EAAS,CAC7B,cAA0BF,QAAQ,CAAC,IAAI,CAAC,wCAAjCG,KAAK,eAAEC,QAAQ,eACtB,eAAkCJ,QAAQ,CAAC,IAAI,CAAC,yCAAzCK,SAAS,eAAEC,YAAY,eAC9B,oBAA2BL,cAAc,EAAE,CAAnCM,IAAI,iBAAJA,IAAI,CAAEC,QAAQ,iBAARA,QAAQ,CAEtB,GAAMC,WAAU,4FAAG,iBAAOC,KAAK,qIAC7BJ,YAAY,CAAC,IAAI,CAAC,CAClBF,QAAQ,CAAC,IAAI,CAAC,CAAC,sBAEQO,MAAK,qBAAcD,KAAK,EAAI,CACjDE,MAAM,CAAE,QAAQ,CAChBC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClCC,aAAa,kBAAYP,IAAI,CAACQ,KAAK,CACrC,CACF,CAAC,CAAC,QANIC,QAAQ,qCAOKA,SAAQ,CAACC,IAAI,EAAE,QAA5BA,IAAI,eAEV,GAAI,CAACD,QAAQ,CAACE,EAAE,CAAE,CAChBZ,YAAY,CAAC,KAAK,CAAC,CACnBF,QAAQ,CAACa,IAAI,CAACE,OAAO,CAAC,CACxB,CACA,GAAIH,QAAQ,CAACE,EAAE,CAAE,CACf;AACAE,YAAY,CAACC,UAAU,CAAC,MAAM,CAAC,CAE/B;AACAb,QAAQ,CAAC,CAACc,IAAI,CAAE,QAAQ,CAAC,CAAC,CAE1B;AACAhB,YAAY,CAAC,KAAK,CAAC,CACrB,CAAC,sDACF,kBA3BKG,WAAU,4CA2Bf,CAED,MAAO,CAAEA,UAAU,CAAVA,UAAU,CAAEJ,SAAS,CAATA,SAAS,CAAEF,KAAK,CAALA,KAAM,CAAC,CACzC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}